---
{{- if .Values.secrets.localSettings.data }}
apiVersion: v1
kind: Secret
metadata:
  name: local-settings-{{ .Values.deployEnv }}
  labels:
    deployEnv: "{{ .Values.deployEnv }}"
type: Opaque
data:
  local_settings.py: {{ .Values.secrets.localSettings.data | b64enc }}
{{- end }}
---
{{- if .Values.web.secrets.googleClient.data }}
apiVersion: v1
kind: Secret
metadata:
  name: google-client-secret-{{ .Values.deployEnv }}
  labels:
    deployEnv: "{{ .Values.deployEnv }}"
type: Opaque
data:
  client_secrets.json: {{ .Values.web.secrets.googleClient.data | b64enc }}
{{- end }}
---
{{- if .Values.varnish.secrets.varnish.data }}
apiVersion: v1
kind: Secret
metadata:
  name: varnish-secret-{{ .Values.deployEnv }}
  labels:
    deployEnv: "{{ .Values.deployEnv }}"
type: Opaque
data:
  varnish-secret: {{ .Values.varnish.secrets.varnish.data | b64enc }}
{{- end }}
---
{{- if .Values.web.secrets.schoolLookup.data }}
apiVersion: v1
kind: Secret
metadata:
  name: school-lookup-data-{{ .Values.deployEnv }}
  labels:
    deployEnv: "{{ .Values.deployEnv }}"
type: Opaque
data:
  schools.tsv: {{ .Values.web.secrets.schoolLookup.data | b64enc }}
{{- end }}
---
{{- if and .Values.secrets.backupManager.key.data .Values.secrets.backupManager.serviceAccount.data }}
apiVersion: v1
kind: Secret
metadata: 
  name: backup-manager-secret-{{ .Values.deployEnv }}
  labels:
    deployEnv: "{{ .Values.deployEnv }}"
type: Opaque
data:
  BackupManagerKey.json: {{ .Values.secrets.backupManager.key.data | b64enc }}
  gcloud-service-accnt.json: {{ .Values.secrets.backupManager.serviceAccount.data | b64enc }}
{{- end }}
---
{{- if or .Values.web.secrets.logging.data }}
apiVersion: v1
kind: Secret
metadata: 
  name: logging-secret-{{ .Values.deployEnv }}
  labels:
    deployEnv: "{{ .Values.deployEnv }}"
type: Opaque
data:
  logging-secret.json: {{ .Values.web.secrets.logging.data | b64enc }}
{{- end }}
---