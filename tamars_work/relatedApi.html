<!DOCTYPE html>
<html>
<body>

<center>
<p> Tamar's Sefaria Project </p>
<p> ______________________________________________ </p>
Enter a Passuk: <input type="text" id="myText">


<p><button type="button" onclick="myFunction()">Go!</button></p>


<p> <audio id="my-audio" controls>
   <source src="" type="audio/mpeg">
</audio> </p>
  </center>
  
<script>
function myFunction() {

	var currentVal = document.getElementById("myText").value;
	var str1 = "http://127.0.0.1:8000/api/related/"
	var url = str1.concat(currentVal);
	
	let jsondata;    
	fetch(url)
		.then((response) => {
			return response.json()
		})
		.then(function(data){
			jsondata = data;
			audio_src = jsondata.audio[0]["audio_url"];
			start_time = jsondata.audio[0]["start_time"]
			end_time = jsondata.audio[0]["end_time"]
		})
	
	var audio = document.getElementById("my-audio");
	audio.setAttribute('src', audio_src);
	audio.currentTime = start_time;
	audio.autoplay = true;
	
	audio.addEventListener("timeupdate", function(){
		if(this.currentTime >= end_time) {
			this.pause();
		}
	});
}



</script>

</body>
</html>
